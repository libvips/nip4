// test the _list lib functions

main = unit_test [
    [any [false, true] == true, "any true"],
    [any [false, false] == false, "no any true"],
    [all [true, true] == true, "all true"],
    [all [false, true] == false, "no all true"],
    ["" ++ "a" == "a", "concat"],
    [delete equal 'b' "abcdb" == "acdb", "delete"],
    [difference equal "asdf" "ad" == "sf", "difference"],
    [drop 3 "abcd" == "d", "drop"],
    [dropwhile is_digit "1234pigs" == "pigs", "dropwhile"],
    [extract 1 [1, 2] == 2, "extract"],
    [filter is_digit "1one2two3three" == "123", "filter"],
    [flatten [[[1, 2]], 3] == [1, 2, 3], "flatten"],
    [foldl (converse cons) [] [1, 2, 3] == [3, 2, 1], "foldl"],
    [foldl1 divide [1, 2, 3] == 1 / 6, "foldl1"],
    [foldr cons [] [1, 2, 3] == [1, 2, 3], "foldr"],
    [foldr1 divide [1, 2, 3] == 1.5, "foldl1"],
    [index (equal 2) [3, 2, 1] == 1, "index"],
    [init [1, 2, 3] == [1, 2], "init"],
    [sum (take 4 (iterate (multiply 2) 1)) == 15, "iterate"],
    [joinsep ", " (map print [1..3]) == "1, 2, 3", "joinsep"],
    [last [1, 2, 3] == 3, "last"],
    [len [1..3] == 3, "len"],
    [limit (iterate (rint @ converse divide 2) 10) == 1, "limit"],
    [sum (map (add 2) [1..3]) == 12, "map"],
    [sum (map2 add [1..3] [4..5]) == 12, "map2"],
    [sum (map3 (\a\b\c a + b + c) [1..3] [4..5] [2..7]) == 17, "map3"],
    [member "0123456789" '7' == is_digit '7', "member"],
    [merge [true, false] [1, 2] [3, 4] == [1, 4], "merge"],
    [mkset equal [1, 2, 3, 1, 2, 1] == [1, 2, 3], "mkset"],
    [postfix [1, 2] 3 == [1, 2, 3], "postfix"],
    [sum (take 4 (repeat 1)) == 4, "repeat"],
    [sum (replicate 4 1) == 4, "replicate"],
    [reverse [1, 2, 3] == [3, 2, 1], "reverse"],
    [sort [3, 2, 1] == [1, 2, 3], "sort"],
    [sortc less [3, 2, 1] == [1, 2, 3], "sortc"],
    [sortpl [\[a, b] a == 2, \[a, b] b == 3]
        [[2, 2], [1, 2], [2, 3]] == [[2, 3], [2, 2], [1, 2]], "sortpl"],
    [sortr [1, 2, 3] == [3, 2, 1], "sortr"],
    [split is_space "  hello world " == ["hello", "world"], "split"],
    [splits (equal ',') ",,1" == ["", "", "1"], "splits"],
    [splitpl [is_digit, is_letter, is_digit] "123cat" == ["123", "cat", []],
        "splitpl"],
    [split_lines 4 "1234567" == ["1234", "567"], "split_lines"],
    [take 3 [1..] == [1, 2, 3], "take"],
    [takewhile is_digit "123onetwothree" == "123", "takewhile"],
    [zip2 [1, 2] ['a', 'b', 'c'] == [[1, 'a'], [2, 'b']], "zip2"],
    [zip3 [1, 2] ['a', 'b', 'c'] [true] == [[1, 'a', true]], "zip3"]
];

